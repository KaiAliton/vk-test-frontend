var b=Object.defineProperty;var g=(s,t,l)=>t in s?b(s,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):s[t]=l;var h=(s,t,l)=>(g(s,typeof t!="symbol"?t+"":t,l),l);import{u as v,r as n,j as e,L as f}from"./index-fe464482.js";function y(s){var o,c,i,d;const t=v(),[l,r]=n.useState(s.post.likes_count),m=()=>{t.post(`/api/v1/post/${s.post.id}/like/`).then(x=>r(x.data.likes_count))};return e.jsxs("div",{className:"bg-primary p-5 rounded-2xl outline outline-1 outline-accent mb-5 flex gap-2 flex-col w-full",children:[e.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[e.jsx("img",{src:`${(o=s.post)==null?void 0:o.author.avatar}`,className:"rounded-full w-10"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(f,{to:`/user/${(c=s.post)==null?void 0:c.author.id}`,children:(i=s.post)==null?void 0:i.author.username}),e.jsx("span",{className:"text-xs text-base-content/70",children:s.post.created})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-start",children:s.post.body}),s.post.cover?e.jsx("img",{src:`${(d=s.post)==null?void 0:d.cover}`}):null,e.jsxs("button",{className:"btn btn-sm btn-accent w-fit",onClick:m,children:["Лайков: ",l]})]})]})}class j extends n.Component{render(){const{children:t,className:l}=this.props;return e.jsx("div",{className:`bg-primary outline outline-1 outline-accent p-3 rounded-xl ${l}`,children:t})}}h(j,"defaultProps",{className:""});function C(){const[s,t]=n.useState(void 0),[l,r]=n.useState(null),[m,o]=n.useState(null),c=v(),i=a=>{t(URL.createObjectURL(a.target.files[0])),r(a.target.files[0]),o(null)},d=()=>{t(void 0),r(null)},x=async a=>{a.preventDefault(),a.target.submit.disabled=!0;const u=new FormData;if(!l&&!a.target.body.value){o("Заполните все поля!"),a.target.submit.disabled=!1;return}console.log(a.target),u.append("body",a.target.body.value),l&&u.append("cover",l),console.log("testing add post"),console.log(u);const p=await c.post("/api/v1/post/",u);console.log(p),p.statusText=="Created"&&window.location.reload(),a.target.submit.disabled=!1,console.log(p)};return e.jsx("div",{className:"w-full rounded-xl mb-5",children:e.jsx("form",{method:"POST",onSubmit:x,children:e.jsxs("div",{className:"w-full outline outline-1 outline-accent  rounded-xl bg-primary ",children:[e.jsx("div",{className:"px-4 py-2 bg-primary rounded-t-xl ",children:e.jsx("textarea",{id:"comment",name:"body",className:"w-full px-0 text-sm bg-primary  border-0 focus:ring-0 ",placeholder:"Напишите что-нибудь, это поле можно оставить пустым."})}),e.jsx("p",{className:"text-red-500",children:m}),l?e.jsxs("div",{className:"relative w-fit m-3",children:[e.jsx("img",{src:s,alt:"",className:"w-32"}),e.jsx("button",{className:"absolute top-0 right-0 bg-slate-100",onClick:d,children:e.jsx("svg",{height:"10px",id:"Layer_1",version:"1.1",viewBox:"0 0 512 512",width:"10px",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M443.6,387.1L312.4,255.4l131.5-130c5.4-5.4,5.4-14.2,0-19.6l-37.4-37.6c-2.6-2.6-6.1-4-9.8-4c-3.7,0-7.2,1.5-9.8,4  L256,197.8L124.9,68.3c-2.6-2.6-6.1-4-9.8-4c-3.7,0-7.2,1.5-9.8,4L68,105.9c-5.4,5.4-5.4,14.2,0,19.6l131.5,130L68.4,387.1  c-2.6,2.6-4.1,6.1-4.1,9.8c0,3.7,1.4,7.2,4.1,9.8l37.4,37.6c2.7,2.7,6.2,4.1,9.8,4.1c3.5,0,7.1-1.3,9.8-4.1L256,313.1l130.7,131.1  c2.7,2.7,6.2,4.1,9.8,4.1c3.5,0,7.1-1.3,9.8-4.1l37.4-37.6c2.6-2.6,4.1-6.1,4.1-9.8C447.7,393.2,446.2,389.7,443.6,387.1z"})})})]}):null,e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-accent border-t  rounded-b-xl bg-primary",children:[e.jsx("input",{type:"submit",value:"Создать пост",name:"submit",className:"disabled:bg-accent/20 btn btn-sm btn-accent"}),e.jsx("div",{className:"flex pl-0 space-x-1 sm:pl-2",children:e.jsxs("label",{htmlFor:"cover",className:" cursor-pointer",children:[e.jsx("svg",{"aria-hidden":"true",className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})}),e.jsx("input",{type:"file",id:"cover",name:"cover",accept:"image/*",onChange:i,onClick:a=>a.target.value=null,className:"hidden"})]})})]})]})})})}export{C as A,y as P,j as T};
